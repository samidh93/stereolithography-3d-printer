/*
 * Amplitudenregler.c
 *
 *  Created on: 10.01.2020
 *      Author: Dominik
 */

/* Variablen:
 *
 *
 *
 * = Regelabweichung
 *
 *
   = Regeldifferenz
 *
 * = Stellgröße
 *
 */
/*
 extern float Schwingeramplitude; //Verhaltnis Hell zu Dunkel
 extern float e; 		// Regelabweichung
 extern float w; 		// Fuhrungsgroße
 float esum 		//Aufsummierung Regelabweicuhung
 float kdc;			//Vorfaktor an H-Brücke
 float kp; 			// P-Anteil des Reglers
 float ki;				// I-Anteil des Reglers
 float kcdmax = 0.45;  // Maximaler Vorfaktor von 0,445 (45%)


 // Tipp: Verhaltnis = (T1 + T3)/(T2+T4)= 1/3


 //Berechnung aktuelle Schwingeramplitude:
 Schwingeramplitude = ((t2-t1)+(t4-t3))/((t3-t2)+(t5-t4));

 //Berechne Regelabweichung
 e = w - Schwingeramplitude;

 //esum berechnen
 esum = esum + e;


 //Pin für I-Potentiometer zuweisen:	Pin PA1
 // kann man das so nehen?      ki = HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_1);

 //Pins für P-Potentiometer zuweisen:	Pin PA4
 // kann man das so nehen?     kp = HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_4);

 //Potti auslesen und für P und I  zwischen 0 und 20 zwueisen


 //Vorfaktor KDC berechnen
 kdc = kp * (e + ki * esum);


 // IF-Bedingung für maximales KDC von 45 %
 if (kdc>0.45)
 {
	 kdc = kdcmax;
	 esum = esum-e
 }

//IF-Bedingung für kdc kleiner als kdcmax
 if (kdc <= 0.45)
 {
	 esum = esum-e; //weis ned ob man das so lassen kann
 }

*/

















//Phase_Lock_Loop






